{% extends 'layout.html' %}
{% block body %}
<div class="container-wide" ng-controller="homeCtrl">
	<div class="row">
		<div class="col-md-10">
			<div id="twitchContainer" style="">
			</div>
		</div>
		<div class="col-md-2" style="background-color:#DDDDDD;height:380px;overflow-y: auto;">
			
			<div class="well" style="width:100%;" ng-repeat="item in currentEvents">
				[[item.name]] - [[item.game]]
			</div>
		</div>
	</div>
	<div class="row">
	<div>
	<h1>Coming Up Events:</h1>
	<div class="well" style="width:100%;" ng-repeat="item in upcomingEvents">
		[[item.startTime.toString()]]:  [[item.name]]
	</div>

  <div id="calendar" style="padding:50px">

  </div>

	</div>
	</div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
function homeCtrl($scope, $http) {
	function Event(name, link, game, date){
		this.name = name;
		this.link = link;
		this.game = game;
		this.startTime = date;
		this.endTime = date;
	}

	$scope.currentEvents = [new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0)), new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0)), new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0)),new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0)),new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0)),new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0)),new Event("EVO", "twitch.com", "Melee", new Date(2014, 07, 11, 8, 30, 0, 0))];

	$scope.upcomingEvents = [];

	var currentDate = new Date();
	$http.get('/api/event/search?orderBy=id&sortOrder=DESC&maxDate='+currentDate.getTime()).
		    success(function(resp, status, headers, config) {
		    	$scope.upcomingEvents = resp.data.results
		    }).
		    	error(function(data, status, headers, config) {
		    });

	getTopGameStream(false, function(twitchPlayer) {
      $("#twitchContainer").append(twitchPlayer);
    });

    $('#calendar').fullCalendar({
      dayClick: function() {
          alert('a day has been clicked!');
      },
        events: [
            {
                title  : 'test event',
                start  : '2014-07-07T13:15:30Z',
                end    : '2014-07-07T15:19:30Z',
                url    : 'http://www.google.com',
                editable : false
            }
        ]

    });
}
</script>
{% endblock %}
